2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Configure stats pid to 3087
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Loading settings from /root/autodl-tmp/EDT/wandb/settings
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/eval_edm.py', 'program_abspath': '/root/autodl-tmp/EDT/scripts/eval_edm.py', 'program': 'scripts/eval_edm.py'}
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:_log_setup():521] Logging user logs to /root/autodl-tmp/EDT/wandb/run-20240429_033232-p8f6dj6g/logs/debug.log
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:_log_setup():522] Logging internal logs to /root/autodl-tmp/EDT/wandb/run-20240429_033232-p8f6dj6g/logs/debug-internal.log
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:init():561] calling init triggers
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'batch_size': 256, 'expert_weight': 15.0, 'env': 'hopper', 'dataset': 'medium-replay', 'rtg_scale': 1000, 'max_eval_ep_len': 1000, 'num_eval_ep': 20, 'dataset_dir': 'data/', 'log_dir': 'dt_runs/', 'context_len': 20, 'n_blocks': 4, 'embed_dim': 512, 'n_heads': 4, 'dropout_p': 0.1, 'ce_weight': 0.001, 'num_bin': 60, 'top_percentile': 0.15, 'dt_mask': False, 'lr': 0.0001, 'wt_decay': 0.0001, 'warmup_steps': 10000, 'max_train_iters': 500, 'num_updates_per_iter': 100, 'mgdt_sampling': False, 'expectile': 0.99, 'device': 'cuda', 'seed': 100, 'eval_iters': 250, 'rs_steps': 2, 'state_loss_weight': 1.0, 'exp_loss_weight': 0.5, 'rs_ratio': 1, 'real_rtg': False, 'data_ratio': 1.0, 'project_name': 'EDT-experiments', 'model_save_iters': 250, 'chk_pt_dir': 'dt_runs/', 'chk_pt_name': 'hopper_medium-replay_4_4_256_60_0.99_100_24-04-27-01-48-27_500.pt', 'render': False, 'heuristic': False, 'heuristic_delta': 1}
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:init():611] starting backend
2024-04-29 03:32:32,787 INFO    MainThread:3087 [wandb_init.py:init():615] setting up manager
2024-04-29 03:32:32,789 INFO    MainThread:3087 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-29 03:32:32,790 INFO    MainThread:3087 [wandb_init.py:init():623] backend started and connected
2024-04-29 03:32:32,794 INFO    MainThread:3087 [wandb_init.py:init():715] updated telemetry
2024-04-29 03:32:32,794 INFO    MainThread:3087 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-04-29 03:32:33,764 INFO    MainThread:3087 [wandb_run.py:_on_init():2357] communicating current version
2024-04-29 03:32:34,440 INFO    MainThread:3087 [wandb_run.py:_on_init():2366] got version response 
2024-04-29 03:32:34,441 INFO    MainThread:3087 [wandb_init.py:init():799] starting run threads in backend
2024-04-29 03:32:34,741 INFO    MainThread:3087 [wandb_run.py:_console_start():2335] atexit reg
2024-04-29 03:32:34,741 INFO    MainThread:3087 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-04-29 03:32:34,742 INFO    MainThread:3087 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-04-29 03:32:34,742 INFO    MainThread:3087 [wandb_run.py:_redirect():2280] Redirects installed.
2024-04-29 03:32:34,744 INFO    MainThread:3087 [wandb_init.py:init():842] run started, returning control to user process
2024-04-29 03:32:41,011 WARNING MsgRouterThr:3087 [router.py:message_loop():77] message_loop has been closed
