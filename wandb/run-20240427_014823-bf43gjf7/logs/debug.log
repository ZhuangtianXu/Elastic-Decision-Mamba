2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Configure stats pid to 69679
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Loading settings from /root/autodl-tmp/EDT/wandb/settings
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train_edm.py', 'program_abspath': '/root/autodl-tmp/EDT/scripts/train_edm.py', 'program': 'scripts/train_edm.py'}
2024-04-27 01:48:23,829 INFO    MainThread:69679 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:_log_setup():521] Logging user logs to /root/autodl-tmp/EDT/wandb/run-20240427_014823-bf43gjf7/logs/debug.log
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:_log_setup():522] Logging internal logs to /root/autodl-tmp/EDT/wandb/run-20240427_014823-bf43gjf7/logs/debug-internal.log
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:init():561] calling init triggers
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'batch_size': 256, 'expert_weight': 15.0, 'env': 'hopper', 'dataset': 'medium-replay', 'rtg_scale': 1000, 'max_eval_ep_len': 1000, 'num_eval_ep': 20, 'dataset_dir': 'data/', 'log_dir': 'dt_runs/', 'context_len': 20, 'n_blocks': 4, 'embed_dim': 512, 'n_heads': 4, 'dropout_p': 0.1, 'ce_weight': 0.001, 'num_bin': 60, 'top_percentile': 0.15, 'dt_mask': False, 'lr': 0.0001, 'wt_decay': 0.0001, 'warmup_steps': 10000, 'max_train_iters': 500, 'num_updates_per_iter': 100, 'mgdt_sampling': False, 'expectile': 0.99, 'device': 'cuda', 'seed': 100, 'eval_iters': 250, 'rs_steps': 2, 'state_loss_weight': 1.0, 'exp_loss_weight': 0.5, 'rs_ratio': 1, 'real_rtg': False, 'data_ratio': 1.0, 'project_name': 'EDT-experiments', 'model_save_iters': 250, 'chk_pt_dir': 'dt_runs/', 'chk_pt_name': 'edt_hopper-medium-replay-v2_model_23-03-06-01-28-21_best.pt', 'render': False, 'heuristic': False, 'heuristic_delta': 1}
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:init():611] starting backend
2024-04-27 01:48:23,830 INFO    MainThread:69679 [wandb_init.py:init():615] setting up manager
2024-04-27 01:48:23,831 INFO    MainThread:69679 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-27 01:48:23,832 INFO    MainThread:69679 [wandb_init.py:init():623] backend started and connected
2024-04-27 01:48:23,836 INFO    MainThread:69679 [wandb_init.py:init():715] updated telemetry
2024-04-27 01:48:23,837 INFO    MainThread:69679 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-04-27 01:48:24,811 INFO    MainThread:69679 [wandb_run.py:_on_init():2357] communicating current version
2024-04-27 01:48:26,694 INFO    MainThread:69679 [wandb_run.py:_on_init():2366] got version response 
2024-04-27 01:48:26,694 INFO    MainThread:69679 [wandb_init.py:init():799] starting run threads in backend
2024-04-27 01:48:26,997 INFO    MainThread:69679 [wandb_run.py:_console_start():2335] atexit reg
2024-04-27 01:48:26,997 INFO    MainThread:69679 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-04-27 01:48:26,997 INFO    MainThread:69679 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-04-27 01:48:26,997 INFO    MainThread:69679 [wandb_run.py:_redirect():2280] Redirects installed.
2024-04-27 01:48:26,998 INFO    MainThread:69679 [wandb_init.py:init():842] run started, returning control to user process
2024-04-27 03:27:29,162 WARNING MsgRouterThr:69679 [router.py:message_loop():77] message_loop has been closed
